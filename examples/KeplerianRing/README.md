Keplerian Ring Test
===================

This test uses the '2D Keplerian Ring' to assess the accuracy of SPH
calculations. For more information on the test, please see Cullen & Dehnen 2009
(http://arxiv.org/abs/1006.1524) Section 4.3.

It is key that for this test in particular that the initial conditions are
perfectly arranged (here we use the same methodology as described in the paper
referenced above).

The test uses:

+ $GM = 1000$ for a central point mass
+ $r = 10$ with $\sigma = 2.5$ gaussian distribution for particles
+ 9745 particles
+ $c_s = 0.01 \ll v_\phi = 10$.

Please note that the initial condition generator **requires python3 rather than
python2**.


Code Setup
----------

You will need to recompile SWIFT with an external potential. This can be done
by using

    ./configure --with-ext-potential=point-mass

in the root directory of the project. We suggest leaving all other code options
as their defaults.


Initial Conditions Generation
-----------------------------

The initial condition generation is handled by ```generate_ics.py```, for which
the options are available with

    python3 generate_ics.py --help


Theory
------

We use the 'spiral' technique to generate the initial conditions. To do this,
we first calculate
$$
    m_i = \frac{i - \frac{1}{2}}{N}
$$
for each particle $i$ with $N$ the total number of required particles. Then the
radius of each particle is given by
$$
    r_i = f^{-1}(m_i)
$$
where for us the PDF $f$ is a Gaussian.

To choose the radial positions, we then choose an initial angle $\theta_1$, and
from there
$$
    \delta \theta_i = \left[2\pi\left( 1 - \frac{r_{i-1}}{r_i} \right)\right]~.
$$

### Inverse CDF of Gaussian

We need:
$$
    f^{-1}(m_i) = r_i = r_{central} + \sqrt{2}\sigma \mathrm{erf}^{-1}(2m_i - 1),
$$
and thankfully scipy has an inverse error function built in.


Implementation Details
----------------------

+ The $m_i$ are generated by ```generate_m_i```.
+ The inverse Gaussian PDF is implemented as ```inverse_gaussian```.
+ The $\theta_i$ are generated by ```generate_theta_i```.


Useful Information
------------------

$G$ in cgs units is given by:
$$
    6.67428 \times 10^{-8} ~ \mathrm{cm}^3 (\mathrm{g} \cdot \mathrm{s}^2)^{-1}.
$$
This is used to convert the mass of the central potential (used in the
parameterfile) to the $GM$ required in the initial conditions generator.